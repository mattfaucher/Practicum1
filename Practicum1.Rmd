---
title: "Practicum1"
author: "Matt Faucher, Kaelyn Jefferson"
date: "10/19/2021"
output: html_document
---
## Connect to the Database
```{r}
library(RSQLite)
path = "~/Documents/Align/Fall2021/CS5200/Practicum1/"
file = "data.db"
con <- dbConnect(RSQLite::SQLite(), paste0(path, file))
```
## Create Incidents Table
```{sql connection=con}
CREATE TABLE IF NOT EXISTS incidents (
  iid INTEGER NOT NULL,
  date DATE NOT NULL,
  depPort VARCHAR(255) NOT NULL,
  arrPort VARCHAR(255) NOT NULL,
  airline VARCHAR(255) NOT NULL DEFAULT 'Unknown',
  aircraft VARCHAR(255) NOT NULL,
  flightPhase VARCHAR(255) NOT NULL,
  impact VARCHAR(255) NOT NULL DEFAULT 'None',
  PRIMARY KEY (iid),
  FOREIGN KEY (airline) REFERENCES airlines(airline)
);
```
## Create Lookup table for Airlines
```{sql connection=con}
CREATE TABLE IF NOT EXISTS airlines (
  aid INTEGER NOT NULL,
  code INTEGER NOT NULL,
  airline VARCHAR(255) NOT NULL DEFAULT 'Unknown',
  PRIMARY KEY (aid),
  FOREIGN KEY (code) REFERENCES airports(code)
);
```
## Create Lookup table for Airports
```{sql connection=con}
CREATE TABLE IF NOT EXISTS airports (
  pid INTEGER NOT NULL,
  code INTEGER NOT NULL,
  name VARCHAR(255) NOT NULL,
  city VARCHAR(255),
  state VARCHAR(255) NOT NULL DEFAULT 'N/A',
  country VARCHAR(255) NOT NULL DEFAULT 'USA',
  PRIMARY KEY (pid),
  FOREIGN KEY (code) REFERENCES airlines(code),
);
```

## Disconnect from the Databse
```{r}
dbDisconnect(con)
```